{"version":3,"file":"client_session.js","sourceRoot":"","sources":["client_session.ts"],"names":[],"mappings":"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","sourcesContent":["import {Common} from './common';\nimport {Session} from './session';\n\n\nexport class ClientSession extends Session {\n  static validParams(params) {\n    if (!Common.validParams(params)) return false;\n\n    if (params.hasOwnProperty('client_max_window_bits')) {\n      if (Common.VALID_WINDOW_BITS.indexOf(params.client_max_window_bits) < 0)\n        return false;\n    }\n    return true;\n  }\n\n  constructor(options){\n      super(options);\n  }\n  public generateOffer() {\n    var offer:any = {};\n\n    if (this._acceptNoContextTakeover)\n      offer.client_no_context_takeover = true;\n\n    if (this._acceptMaxWindowBits !== undefined) {\n      if (Common.VALID_WINDOW_BITS.indexOf(this._acceptMaxWindowBits) < 0) {\n        throw new Error('Invalid value for maxWindowBits');\n      }\n      offer.client_max_window_bits = this._acceptMaxWindowBits;\n    } else {\n      offer.client_max_window_bits = true;\n    }\n\n    if (this._requestNoContextTakeover)\n      offer.server_no_context_takeover = true;\n\n    if (this._requestMaxWindowBits !== undefined) {\n      if (Common.VALID_WINDOW_BITS.indexOf(this._requestMaxWindowBits) < 0) {\n        throw new Error('Invalid valud for requestMaxWindowBits');\n      }\n      offer.server_max_window_bits = this._requestMaxWindowBits;\n    }\n\n    return offer;\n  }\n  public activate(params) {\n    if (!ClientSession.validParams(params)) return false;\n\n    if (this._acceptMaxWindowBits && params.client_max_window_bits) {\n      if (params.client_max_window_bits > this._acceptMaxWindowBits) return false;\n    }\n\n    if (this._requestNoContextTakeover && !params.server_no_context_takeover)\n      return false;\n\n    if (this._requestMaxWindowBits) {\n      if (!params.server_max_window_bits) return false;\n      if (params.server_max_window_bits > this._requestMaxWindowBits) return false;\n    }\n\n    this._ownContextTakeover = !(this._acceptNoContextTakeover || params.client_no_context_takeover);\n    this._ownWindowBits = Math.min(\n        this._acceptMaxWindowBits || Common.MAX_WINDOW_BITS,\n        params.client_max_window_bits || Common.MAX_WINDOW_BITS\n    );\n\n    this._peerContextTakeover = !params.server_no_context_takeover;\n    this._peerWindowBits = params.server_max_window_bits || Common.MAX_WINDOW_BITS;\n\n    return true;\n  }\n}\n\n"]}