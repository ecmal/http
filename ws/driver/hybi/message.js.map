{"version":3,"file":"message.js","sourceRoot":"","sources":["message.ts"],"names":[],"mappings":";IAAA;QAgBE,sBAAI,GAAJ;YACE,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;gBAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;YAEhC,IAAI,CAAC,IAAI,GAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACrC,IAAI,MAAM,GAAG,CAAC,CAAC;YAEf,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBACpD,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;gBACxC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;YACnC,CAAC;YACD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;QACnB,CAAC;QACD,2BAAS,GAAT,UAAU,KAAK;YACX,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC;YACpC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC;YACpC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC;YAEpC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC;gBAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;YAErD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YACjC,IAAI,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC;QAC9B,CAAC;QACL,cAAC;QA9BC;YACE,IAAI,CAAC,IAAI,GAAM,KAAK,CAAC;YACrB,IAAI,CAAC,IAAI,GAAM,KAAK,CAAC;YACrB,IAAI,CAAC,IAAI,GAAM,KAAK,CAAC;YACrB,IAAI,CAAC,MAAM,GAAI,IAAI,CAAC;YACpB,IAAI,CAAC,MAAM,GAAI,CAAC,CAAC;YACjB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QACpB,CAAC;IAuBH,CAAC,AAtCD,IAsCC;;IAtCD,iCAsCC,CAAA;;;;YAtCD,sBAAA,OAsCC","sourcesContent":["export class Message {\n  public rsv1:boolean;\n  public rsv2:boolean;\n  public rsv3:boolean;\n  public opcode:number;\n  public length:number;\n  public data:Buffer;\n  private _chunks:any[];\n  constructor() {\n    this.rsv1    = false;\n    this.rsv2    = false;\n    this.rsv3    = false;\n    this.opcode  = null;\n    this.length  = 0;\n    this._chunks = [];\n  }\n  read() {\n    if (this.data) return this.data;\n\n    this.data  = new Buffer(this.length);\n    var offset = 0;\n\n    for (var i = 0, n = this._chunks.length; i < n; i++) {\n      this._chunks[i].copy(this.data, offset);\n      offset += this._chunks[i].length;\n    }\n    return this.data;\n  }\n  pushFrame(frame) {\n      this.rsv1 = this.rsv1 || frame.rsv1;\n      this.rsv2 = this.rsv2 || frame.rsv2;\n      this.rsv3 = this.rsv3 || frame.rsv3;\n\n      if (this.opcode === null) this.opcode = frame.opcode;\n\n      this._chunks.push(frame.payload);\n      this.length += frame.length;\n    }\n}\n\n"]}