{"version":3,"file":"ring_buffer.js","sourceRoot":"","sources":["ring_buffer.ts"],"names":[],"mappings":"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","sourcesContent":["export class RingBuffer {\n\n  public length:number;\n\n  private _buffer:any[];\n  private _bufferSize:number;\n  private _ringOffset:number;\n  private _ringSize:number;\n  private _head:number;\n  private _tail:number;\n\n\n  public constructor(bufferSize) {\n    this._buffer     = new Array(bufferSize);\n    this._bufferSize = bufferSize;\n    this._ringOffset = 0;\n    this._ringSize   = bufferSize;\n    this._head       = 0;\n    this._tail       = 0;\n    this.length      = 0;\n  }\n  public push(value) {\n    var expandBuffer = false,\n        expandRing   = false;\n\n    if (this._ringSize < this._bufferSize) {\n      expandBuffer = (this._tail === 0);\n    } else if (this._ringOffset === this._ringSize) {\n      expandBuffer = true;\n      expandRing   = (this._tail === 0);\n    }\n\n    if (expandBuffer) {\n      this._tail       = this._bufferSize;\n      this._buffer     = this._buffer.concat(new Array(this._bufferSize));\n      this._bufferSize = this._buffer.length;\n\n      if (expandRing)\n        this._ringSize = this._bufferSize;\n    }\n\n    this._buffer[this._tail] = value;\n    this.length += 1;\n    if (this._tail < this._ringSize) this._ringOffset += 1;\n    this._tail = (this._tail + 1) % this._bufferSize;\n  }\n  public peek() {\n    if (this.length === 0) return void 0;\n    return this._buffer[this._head];\n  }\n  public shift() {\n    if (this.length === 0) return void 0;\n\n    var value = this._buffer[this._head];\n    this._buffer[this._head] = void 0;\n    this.length -= 1;\n    this._ringOffset -= 1;\n\n    if (this._ringOffset === 0 && this.length > 0) {\n      this._head       = this._ringSize;\n      this._ringOffset = this.length;\n      this._ringSize   = this._bufferSize;\n    } else {\n      this._head = (this._head + 1) % this._ringSize;\n    }\n    return value;\n  }\n}\n\n"]}